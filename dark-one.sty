%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% DARK-ONE.STY
%% Based on `proto-one` 2019/04/04 [v2]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\ProvidesPackage{dark-one}
  [2019/04/04 (proto-one) Common Macros and Settings]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% OPTION: dvipdfmx
\newif\if@darkone@options@dvipdfmx
\DeclareOption{dvipdfmx}{\@darkone@options@dvipdfmxtrue}
\DeclareOption{nodvipdfmx}{\@darkone@options@dvipdfmxfalse}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  dvipdfmx用のドライバをまとめて設定する。
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\do@darkone@options@dvipdfmx{%
  \PassOptionsToPackage{dvipdfmx}{color}%
  \PassOptionsToPackage{dvipdfmx}{xcolor}%
  \PassOptionsToPackage{dvipdfm}{geometry}% この dvipdfm は typo ではない
  \PassOptionsToPackage{dvipdfmx}{graphics}%
  \PassOptionsToPackage{dvipdfmx}{graphicx}%
  \PassOptionsToPackage{dvipdfmx}{hyperref}%
  \PassOptionsToPackage{dvipdfmx}{texshade}%
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% OPTION: exscale
\newif\if@darkone@options@exscale
\DeclareOption{exscale}{\@darkone@options@exscaletrue}
\DeclareOption{noexscale}{\@darkone@options@exscalefalse}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  exscale パッケージを読み込む：
%     数式フォントのサイズをより柔軟にする。
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\do@darkone@options@exscale{%
  \RequirePackage{exscale}%
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% OPTION: a5j-legacy
\newif\if@darkone@options@afivejlegacy
\DeclareOption{a5j-legacy}{\@darkone@options@afivejlegacytrue}
\DeclareOption{noa5j-legacy}{\@darkone@options@afivejlegacyfalse}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \documentclass のオプションに a5j を指定したときの追加設定
% ※ A5判サイズで「狭い余白」を設定する
% ※ twoside の場合は考慮していない
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\do@darkone@options@afivejlegacy{%
  \RequirePackage{geometry}
  \topmargin-2.3cm\advance\textheight3cm%
  \topskip10pt%
  \oddsidemargin-1.0cm\advance\textwidth1.3cm%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% OPTION: a5j (deprecated)
\DeclareOption{a5j}{\do@afivejwarning}
\DeclareOption{noa5j}{\do@noafivejwarning}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\do@afivejwarning{%
  % \PackageWarningNoLine{dark-one}{a5j オプションは廃止されました}%
  % \typeout{\space\space 旧設定を使用するときは a5j-legacy を指定してください。}%
  % \typeout{\space\space なお、次のような設定も有用でしょう:}%
  % \typeout{}%
  % \typeout{\space\space\space\space\string\RequirePackage{geometry}}%
  % \typeout{\space\space\space\space\string\geometry{left=15mm,right=15mm}}%
  % \typeout{\space\space\space\space\string\geometry{top=17mm,bottom=17mm}}%
  % \typeout{}%
}
\def\do@noafivejwarning{%
  % \PackageWarningNoLine{dark-one}{noa5j オプションは廃止されました}%
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% OPTION: small
\newif\if@darkone@options@small
\DeclareOption{small}{\@darkone@options@smalltrue}
\DeclareOption{nosmall}{\@darkone@options@smallfalse}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% (1) \normalsize を \small と同じにする。
% (2) \truenormalsize にもともとの \normalsize を保存しておく。
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\do@darkone@options@small{%
  \let\truenormalsize\normalsize%
  \let\normalsize\small%
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% OPTION: hyperref
\newif\if@darkone@options@hyperref
\DeclareOption{hyperref}{\@darkone@options@hyperreftrue}
\DeclareOption{nohyperref}{\@darkone@options@hyperreffalse}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% hyperref パッケージの設定
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\do@darkone@options@hyperref{%
  \PassOptionsToPackage{setpagesize=false}{hyperref}%
  \RequirePackage{hyperref}%
  \RequirePackage{pxjahyper}% PDFのしおりの文字化けを防ぐ
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  % ラベルの名前の先頭に '\jobname-' を付け加える
  % ※複数のPDFをつなげたときに、しおり等が衝突しないようにする
  \renewcommand*{\HyperDestNameFilter}[1]{%
    \jobname-\HyperDestLabelReplace{##1}%
  }
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% OPTION: fixunnumberedsections
\newif\if@darkone@options@fixunnumberedsections
\DeclareOption{fixunnumberedsections}{\@darkone@options@fixunnumberedsectionstrue}
\DeclareOption{nofixunnumberedsections}{\@darkone@options@fixunnumberedsectionsfalse}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% fixunnumberedsections パッケージの設定
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\do@darkone@options@fixunnumberedsections{%
  \if@darkone@options@hyperref% hyperrefを使うときだけ設定
    % This package is available at http://tex.stackexchange.com/q/33696/
    \RequirePackage{etoolbox}
    \patchcmd{\@startsection}{\@ssect{##3}{##4}{##5}{##6}}{\@dblarg{\@sect{##1}{\@m}{##3}{##4}{##5}{##6}}}{}{\PackageError{fix-unnumbered-sections}{Unable to patch \string\@startsection; are you using a non-standard document class?}\@ehd}
  \fi%
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% OPTION: logo
\newif\if@darkone@options@logo
\DeclareOption{logo}{\@darkone@options@logotrue}
\DeclareOption{nologo}{\@darkone@options@logofalse}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% ロゴマクロ \cons の定義
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\do@darkone@options@logo{%
  \RequirePackage{graphics}%
  \DeclareMathVersion{traditional}
  \SetSymbolFont{operators}{traditional}{OT1}{cmr}{m}{n}
  \SetSymbolFont{letters}{traditional}{OML}{cmm}{m}{it}
  \SetSymbolFont{symbols}{traditional}{OMS}{cmsy}{m}{n}
  \SetSymbolFont{largesymbols}{traditional}{OMX}{cmex}{m}{n}
  \def\cons{\mbox{%
    \fontencoding{OT1}\fontfamily{cmr}\fontseries{m}\fontshape{n}%
    \selectfont%
    \mathversion{traditional}$\displaystyle%
    {\sum}\mkern-14.39mu%
    \makebox[0pt][l]{\raisebox{-.036ex}{%
    \fontencoding{OT1}\fontfamily{cmr}\fontseries{m}\fontshape{sl}%
    \selectfont%
    \,\kern-0.025ex\`\null}\hss}%
    \raisebox{-.037ex}{${\infty}\mkern-13.23mu%
    {\cdot}\mkern3.48mu{\cdot}$}$}}
  \def\truecons{%
    \ifx\truenormalsize\@undefined%
      {\normalsize\cons}%
    \else%
      {\truenormalsize\cons}%
    \fi}%
  \def\consk{\reflectbox{\mbox{%
    \fontencoding{OT1}\fontfamily{cmr}\fontseries{m}\fontshape{n}%
    \selectfont%
    %\smash{\raisebox{-.14ex}{\makebox[0pt][l]{\scalebox{.8}{\kern-.55ex K}}}}%
    \makebox[0pt][l]{%
    \fontencoding{OT1}\fontfamily{cmr}\fontseries{m}\fontshape{n}%
    \selectfont%
    \mathversion{traditional}$\displaystyle%
    {\sum}\mkern-14.39mu%
    \makebox[0pt][l]{\raisebox{-.036ex}{%
    \fontencoding{OT1}\fontfamily{cmr}\fontseries{m}\fontshape{sl}%
    \selectfont%
    \,\kern-0.025ex\`\null}\hss}%
    \raisebox{-.037ex}{${\infty}\mkern-13.23mu%
    \hspace*{-.65ex}{\cdot}\mkern3.48mu\hspace*{-.025ex}{\cdot}$}$}%
    \phantom{\cons}%
    }}}
  \def\trueconsk{%
    \ifx\truenormalsize\@undefined%
      {\normalsize\consk}%
    \else%
      {\truenormalsize\consk}%
    \fi}%
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% OPTION: draftgithashes
\newif\if@darkone@options@draftgithashes
\DeclareOption{draftgithashes}{\@darkone@options@draftgithashestrue}
\DeclareOption{nodraftgithashes}{\@darkone@options@draftgithashesfalse}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% draftgithashes オプションの設定
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\do@darkone@options@draftgithashes{%
  \newcommand{\LoadGitHashLines}[2][\GitHashLines]{%
    \let\GitHashLines\@GitHashLines% 初期化する
    \@input@{##2}%
    \let##1\GitHashLines}
  % つぎの \GitHashLines は \LoadGitHashLines の際に上書きされる
  \def\@GitHashLines{\GitHashLine{NO HASH}{LOADED}{.}}
  \let\GitHashLines\@GitHashLines
  % デフォルト設定
  \def\@githashes@raw##1{{%
    \edef\tmp@a{##1}%
    \escapechar=-1\relax%
    \expandafter\string\csname\tmp@a\endcsname}}%
  %\def\GitHashLine##1##2##3{\item{\tt##1 ##2 ##3}}
  \def\GitHashLine##1##2##3{\item{\def\@e{}\def\@t{##2}%
    \ifx\@e\@t%
      \texttt{\@githashes@raw{##1} \@githashes@raw{##3}}%
    \else%
      \texttt{\@githashes@raw{##1} \@githashes@raw{##2} \@githashes@raw{##3}}%
    \fi}}%
  \newcommand{\PrintGitHashes}[1][\GitHashLines]{%
    \begin{list}{}{%
      \baselineskip2ex%
      \itemsep0pt\relax%
      \labelwidth0pt\relax%
      \labelsep0pt\relax%
      \leftmargin0pt\relax%
      \listparindent0pt\relax%
      \parsep0pt\relax%
      \partopsep0pt\relax%
      \topsep0pt\relax%
      \rightmargin0pt\relax}%
      ##1%
    \end{list}}
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  \RequirePackage{color}
  \RequirePackage{everypage}
  %%%%%%%%%%%%%%%%
  \newif\if@draft@print@githashes@\@draft@print@githashes@false
  \newcommand{\print@draft@githashes}[1]{% draftwatermark.sty より
    \if@draft@print@githashes@%
    \setbox\@tempboxa\vbox to \z@{%
      \vskip -1in \moveleft 1in \vbox{%
    \hbox to \z@{%
          ##1\hss}}\vss}
    \dp\@tempboxa\z@
    \box\@tempboxa
    \fi}
  \def\SetDraftHashes##1{%
    \def\DraftHashes{\raisebox{-10mm}{\hspace{10mm}\parbox{\textwidth}{%
      \color{red}\scriptsize\PrintGitHashes[##1]}}}}
  \def\DraftHashes{}
  \AddEverypageHook{\print@draft@githashes{\DraftHashes}}
  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  \def\EnableDraftPrintGitHashes{\@draft@print@githashes@true}
  \def\DisableDraftPrintGitHashes{\@draft@print@githashes@false}
  \def\EnableDraftPrintGitHashesIfFileExists##1{\IfFileExists{##1}%
    {\EnableDraftPrintGitHashes}{\DisableDraftPrintGitHashes}}%
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% OPTION: draftnotes
\newif\if@darkone@options@draftnote
\DeclareOption{draftnotes}{\@darkone@options@draftnotetrue}
\DeclareOption{nodraftnotes}{\@darkone@options@draftnotefalse}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% draftnote オプションの設定
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\do@darkone@options@draftnote{%
\RequirePackage{color}
\RequirePackage{currfile}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newif\if@dark@draftnote@\@dark@draftnote@false
\newif\if@draft@print@filename@\@draft@print@filename@false
\newif\if@draft@print@comments@\@draft@print@comments@false
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% インターフェース
%% 各種校正用設定のためのコマンド

%% \EnablePrintNotes%          % 校正用: ノートを表示する
%% \DisablePrintNotes%         % 本番用: ノートを表示しない（デフォルト）
\def\EnablePrintNotes{\@dark@draftnote@true}
\def\DisablePrintNotes{\@dark@draftnote@false}

%% \EnablePrintComments%       % 校正用: コメントを表示する
%% \DisablePrintComments%      % 本番用: コメントを表示しない（デフォルト）
\def\EnablePrintComments{\@draft@print@comments@true}
\def\DisablePrintComments{\@draft@print@comments@false}

%% \EnablePrintFileNames% % 校正用: ファイル名を表示する
%% \DisablePrintFileNames%% 本番用: ファイル名を表示しない（デフォルト）
\def\EnablePrintFileNames{\@draft@print@filename@true}
\def\DisablePrintFileNames{\@draft@print@filename@false}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% \EnableDraftNotes%  % 校正用: 上記すべてについて表示する
%% \DisableDraftNotes% % 本番用: 上記すべてについて表示しない（デフォルト）
\def\EnableDraftNotes{%
  \EnablePrintNotes%
  \EnablePrintComments%
  \EnablePrintFileNames%
}
\def\DisableDraftNotes{%
  \DisablePrintNotes%
  \DisablePrintComments%
  \DisablePrintFileNames%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% draftnote用の外部ファイル操作
\newcounter{@@draftnote}
\newwrite\out@draftnotes
\def\open@draftnotes{\immediate\openout\out@draftnotes\jobname.ntd\relax}
\def\header@draftnotes{\immediate\write\out@draftnotes{%
  \unexpanded{\typeout{DARK-STYLE: Loading Draft Notes...}}}}
\def\close@draftnotes{\immediate\closeout\out@draftnotes\relax}
\def\load@draftnotes{\makeatletter\@input@{\jobname.ntd}\makeatother}
\def\list@draftnotes{\clearpage\begin{list}{}{%
  \itemsep0pt\relax%
  \itemindent-2zw\relax%
  \labelwidth0pt\relax%
  \labelsep0pt\relax%
  %\leftmargin0pt\relax%
  \leftmargin2zw\relax%
  \listparindent0pt\relax%
  \parsep0pt\relax%
  \partopsep0pt\relax%
  \topsep0pt\relax%
  \rightmargin0pt\relax}%
  \item Draft Notes
  \load@draftnotes\end{list}\clearpage}

\def\write@draftnote##1{%
  \addtocounter{@@draftnote}{1}%
  \immediate\write\out@draftnotes{%
    \unexpanded{\ItemDraftNote{##1}}%
    {\currfilepath}%
    {\number\inputlineno}%
    {\the@@draftnote}%
    {\thepage}%
    {\thesection}%
    {\thesubsection}}}
\gdef\ItemDraftNote@last{}%                 % ★ .ntd ファイルへの出力が
\def\ItemDraftNote##1##2##3##4##5##6##7{%
  \gdef\ItemDraftNote@curr{##4}%             % ★なぜか重複していることが
  \ifx\ItemDraftNote@curr\ItemDraftNote@last% ★あるので、重複を回避する
  \else%                                    % ★
  \item \textcolor{red}{%
    \@draftnote@mark@number{##4}}~P.~##5
    (\texttt{\@draftnote@raw{##2}},~\texttt{L.##3}):\\{##1}%
  \gdef\ItemDraftNote@last{##4}%             % ★
  \fi%                                      % ★
  }
\def\@draftnote@raw##1{{%
  \edef\tmp@a{##1}%
  \escapechar=-1\relax%
  \expandafter\string\csname\tmp@a\endcsname}}

%\def\OpenDraftNotes{\open@draftnotes}
%\def\HeaderDraftNotes{\header@draftnotes}
\def\StartDraftNotes{\open@draftnotes\header@draftnotes}
%\def\CloseDraftNotes{\close@draftnotes}
%\def\ListDraftNotes{\list@draftnotes}
\def\WriteDraftNote##1{\write@draftnote{##1}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% 校正用のノートを作成するためのマクロ
\def\@draftnote@mark@number##1{{[##1]}}
\def\@draftnote@mark{\smash{\llap{\textcolor{red}{\raisebox{-1.25ex}{%
  \scriptsize\@draftnote@mark@number{\the@@draftnote}%
  }}}}}%
% インターフェース
\def\draftnote##1{%
  \rule{0pt}{0pt}%
  \WriteDraftNote{##1}%
  \if@dark@draftnote@%
    \@draftnote@mark%
  \fi%
}
\def\PrintDraftNotes{%
  \close@draftnotes%
  \if@dark@draftnote@%
    \ifnum\value{@@draftnote}>0%
      \list@draftnotes%
    \else%
      \typeout{DARK-STYLE: DARK-DRAFT: No draftnote...}%
    \fi%
  \fi%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% 校正用にコメントを表示するためのマクロ（本文内に上書きする）
\def\@DraftCommentL##1{{% コメントを左側に表示するマクロの実体
  \smash{\llap{\textcolor{magenta}{{\scriptsize##1}}}}}}
\def\@DraftCommentR##1{{% コメントを右側に表示するマクロの実体
  \smash{\rlap{\textcolor{magenta}{{\scriptsize##1}}}}}}

% インターフェース
\def\draftcommentL##1{\rule{0pt}{0pt}\if@draft@print@comments@\@DraftCommentL{\raisebox{-1.25ex}{##1}}\fi}
\def\draftcommentR##1{\rule{0pt}{0pt}\if@draft@print@comments@\@DraftCommentR{\raisebox{-1.25ex}{##1}}\fi}
\def\DraftCommentL##1{\rule{0pt}{0pt}\if@draft@print@comments@\@DraftCommentL{##1}\fi}
\def\DraftCommentR##1{\rule{0pt}{0pt}\if@draft@print@comments@\@DraftCommentR{##1}\fi}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% 校正用にファイル名を表示するためのマクロ
\def\@DraftPrintFileNameL##1{{% ファイル名を左側に表示するマクロの実体
  \edef\tmp@a{##1}%
  \smash{\llap{%
    \textcolor{red}{\tiny\texttt{%
      \escapechar=-1\relax\expandafter\string\csname\tmp@a\endcsname%
    }}%
  }}%
}}
\def\@DraftPrintFileNameR##1{{% ファイル名を右側に表示するマクロの実体
  \edef\tmp@a{##1}%
  \smash{\rlap{%
    \textcolor{red}{\tiny\texttt{%
      \escapechar=-1\relax\expandafter\string\csname\tmp@a\endcsname%
    }}%
  }}%
}}
% インターフェース
\def\DraftPrintFileNameL##1{\rule{0pt}{0pt}\if@draft@print@filename@\@DraftPrintFileNameL{##1}\fi}
\def\DraftPrintFileNameR##1{\rule{0pt}{0pt}\if@draft@print@filename@\@DraftPrintFileNameR{##1}\fi}

%% 例えば次のようにして使うとよい
%\def\zu##1##2{\hfill\includegraphics[width=##2]{eps/##1}%
%  \DraftPrintFileNameL{##1}\hfill\mbox{}\par}
%% 注意：\zuを使用しているとき、参照ラベルをつけるには、
%%       その直前に\labelを入れる
%%       (\parを使用していて、ページ番号がずれることがあるため)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\StartDraftNotes
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%







%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% OPTION: okuduke
\newif\if@darkone@options@okuduke
\DeclareOption{okuduke}{\@darkone@options@okuduketrue}
\DeclareOption{nookuduke}{\@darkone@options@okudukefalse}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% okuduke オプションの設定
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\do@darkone@options@okuduke{%
  \newcommand{\okudukeskip}{%
    \vskip0mm%
    \mbox{}\vskip-\baselineskip%
    \vskip10mm\vfill}%
  \newenvironment{okuduke}[1]{%
    \begin{minipage}{##1}%
    \ifx\truenormalsize\@undefined%
    \else%
      \let\normalsize\truenormalsize%
    \fi%
    \parindent0mm%
  }{%
    \end{minipage}%
  }%
  \newenvironment{oDate}{%
    \vskip0mm%
    \begin{tabular}{@{}c@{\hskip\xkanjiskip}c%
      @{\hskip\xkanjiskip}c@{\hskip\xkanjiskip}c%
      @{\hskip\xkanjiskip}c@{\hskip\xkanjiskip}c%
      @{ }l@{}}%
  }{\end{tabular}\vskip0mm}%
  \newenvironment{oInfo}{%
    \vskip0mm%
    \begin{tabular}{@{\hskip2zw}c@{\hskip2zw}l@{}}%
  }{\end{tabular}\vskip0mm}%
  \newcommand{\oSetTitle}[1]{%
    \def\oTitle{{\normalsize\bfseries##1}\vskip0mm\relax}}%
  \newcommand{\oSetDateLines}[1]{%
    \def\oDateLines{\begin{oDate}##1\end{oDate}}}%
  \let\oDateLines\relax%
  \newcommand{\oSetInfoLines}[1]{%
    \def\oInfoLines{\begin{oInfo}##1\end{oInfo}}}%
  \let\oInfoLines\relax%
  \newcommand{\oSetCopyrightYear}[1]{\def\oCopyrightYear{##1}}%
  \newcommand{\oSetPrice}[1]{\def\oPrice{##1}}%
  \newcommand{\oSetISBN}[1]{\def\oISBN{##1}}%
  \newcommand{\oSetBunrui}[1]{\def\oBunrui{##1}}%
  \newcommand{\oSetLogoPhrase}[1]{\def\oLogoPhrase{##1}}%
  \newlength{\oruleheight}%
  \oruleheight1mm%
  \newcommand{\orulefill}[1][\oruleheight]{\hrule height ##1 \hfill\relax}%
  \newlength{\oLogoWidth}
  \oLogoWidth1cm%
  \newlength{\oLogoRemainderWidth}%
  \newcommand{\oSetLogoWidth}[1]{%
     \setlength{\oLogoWidth}{##1}%
     \oSetLogoRemainderWidth}%
  \newcommand{\oSetLogoRemainderWidth}{%
    \oLogoRemainderWidth\textwidth%
    \advance\oLogoRemainderWidth-\oLogoWidth}%
  \newcommand{\oLastLine}[1]{{\footnotesize##1}\vskip0mm}%
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% OPTION: load-adhoc
\newif\if@darkone@options@loadadhoc
\DeclareOption{load-adhoc}{\@darkone@options@loadadhoctrue}
\DeclareOption{noload-adhoc}{\@darkone@options@loadadhocfalse}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% load-adhoc オプションの設定
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\do@darkone@options@loadadhoc{%
  \IfFileExists{./dark-adhoc.sty}{\RequirePackage{dark-adhoc}}{}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% OPTION: load-okuduke
\newif\if@darkone@options@loadokuduke
\DeclareOption{load-okuduke}{\@darkone@options@loadokuduketrue}
\DeclareOption{noload-okuduke}{\@darkone@options@loadokudukefalse}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% load-okuduke オプションの設定
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\do@darkone@options@loadokuduke{%
  \AtEndDocument{\IfFileExists{./okuduke.tex}{\input{okuduke.tex}}{}}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% デフォルト設定
\ExecuteOptions{%
  dvipdfmx,noexscale,%
  nologo,nookuduke,%
  nosmall,noa5j-legacy%
  nohyperref,fixunnumberedsections,%
  nodraftgithashes,%
  nodraftnotes,%
  load-adhoc,load-okuduke}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% オプション設定
\ProcessOptions\relax

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% 依存関係
\if@darkone@options@okuduke\@darkone@options@logotrue\fi

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% オプション設定に応じた処理
\if@darkone@options@dvipdfmx\do@darkone@options@dvipdfmx\fi
\if@darkone@options@exscale\do@darkone@options@exscale\fi
\if@darkone@options@afivejlegacy\do@darkone@options@afivejlegacy\fi
\if@darkone@options@small\do@darkone@options@small\fi
\if@darkone@options@logo\do@darkone@options@logo\fi
\if@darkone@options@okuduke\do@darkone@options@okuduke\fi
\if@darkone@options@hyperref\do@darkone@options@hyperref\fi
\if@darkone@options@fixunnumberedsections\do@darkone@options@fixunnumberedsections\fi
\if@darkone@options@draftgithashes\do@darkone@options@draftgithashes\fi
\if@darkone@options@loadadhoc\do@darkone@options@loadadhoc\fi
\if@darkone@options@loadokuduke\do@darkone@options@loadokuduke\fi
\if@darkone@options@draftnote\do@darkone@options@draftnote\fi
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\endinput




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% OPTION: sample
\newif\if@darkone@options@sample
\DeclareOption{sample}{\@darkone@options@sampletrue}
\DeclareOption{nosample}{\@darkone@options@samplefalse}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% sample オプションの設定
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\do@darkone@options@sample{}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\if@darkone@options@sample\do@darkone@options@sample\fi

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




%%%% $ FilePath: dark-one.sty $
%%%% $ FileHash: f9191e31dd89a9ef733cb6f035ea43430db72ae5 $
%%%% $ FileAuthorDate: 2019-04-04T04:04:04+09:00 $
%%%% $ FileCommitDate: 2019-04-04T04:04:04+09:00 $
%%%% $ FileCommitHash: 3faab843b277137d8b621a01e1abf1ba1c5b2971 $
%%%% $ AuthorDate: 2019-04-04T04:04:04+09:00 $
%%%% $ CommitDate: 2019-04-04T04:04:04+09:00 $
%%%% $ CommitHash: 3faab843b277137d8b621a01e1abf1ba1c5b2971 $
%%%% $ ProjectName: proto-one $
%%%% $ RefName: v2_d20190404 $
%%%% $ Status: $
